@model RTEXERP.Contracts.BLModels.FiniteScheduler.OvalPrintingReportMasterViewModel
@{
    ViewData["Title"] = $"Oval Printing Report";
    Layout = null;
    int sl = 0;
    var bgColor = "";
}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.6">
    <title>Oval Printing Report</title>


    <meta name="theme-color" content="#563d7c">

    <link href="~/AdminLTE-3.1.0-rc/dist/css/adminlte.min.css" rel="stylesheet" />
    <script src="~/AdminLTE-3.1.0-rc/plugins/jquery/jquery.min.js"></script>
    @*<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>*@

    <style>
        table.floatThead-table {
            border-top: none;
            border-bottom: none;
            background-color: #fff;
        }
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        table thead {
            text-align: center;
        }

        table {
            table-layout: fixed;
        }

        td {
            word-wrap: break-word
        }

        table.table-bordered {
            border: 1px solid #000;
            margin-top: 20px;
        }

            table.table-bordered > thead > tr > th {
                border: 1px solid #000;
            }

            table.table-bordered > tbody > tr > td {
                border: 1px solid #000;
            }

            table.table-bordered > tfoot > tr > td {
                border: 1px solid #000;
            }
    </style>
    <!-- Custom styles for this template -->
    <link href="~/css/BatchReportCss.css" rel="stylesheet" />
    <link href="~/css/landscapePrint.css" rel="stylesheet" />
    <link href="~/css/printCommon.css" rel="stylesheet" />
</head>
<body>
    @*<nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
        <div class="navbar-brand col-sm-12 col-md-12 mr-0">Oval Printing Report</div>
    </nav>*@

    <div class="container-fluid">
        @*<main role="main" class="col-md-12 ml-sm-auto col-lg-12 px-4 printArea">*@
        <div class="col-md-12 col-sm-12 col-lg-12">
            <span>&nbsp;</span>
            <div class="row">
                <div class="col-md-5">
                    <table class="table table-sm table-bordered mdReport mt-0 pt-0" style="font-weight:bold;font-size:12px;">
                        <thead style="font-size:12px;">
                            <tr class="table-thead">
                                <th colspan="6">Pfofit/Loss (BDT)</th>

                            </tr>
                            <tr class="table-thead">
                                <th style="vertical-align:middle">Type</th>
                                <th style="vertical-align:middle">Total Earining</th>
                                <th style="vertical-align:middle;padding-left:2px;padding-right:5px;">Dyes/Chemical<br>Cost</th>
                                <th style="vertical-align:middle">Salary</th>
                                <th style="vertical-align:middle">Total Cost</th>
                                <th style="vertical-align: middle">Total Profit</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-thead">
                                @{
                                    var totalProfit = Model.TotalProfitBDT - (double)Model.OvalPerDayTotalSalary;
                                    bgColor = totalProfit >= 0 ? "text-light bg-success" : "text-light bg-danger";
                                }
                                <td>Chest</td>
                                <td class="table-body text-center">@String.Format("{0:n2}", Model.TotalPriceBDT)</td>
                                <td class="table-body text-center">@String.Format("{0:n2}", Model.TotalCostBDT)</td>
                                <td class="table-body text-center">@String.Format("{0:n2}", Model.OvalPerDayTotalSalary)</td>
                                <td class="table-body text-center">@String.Format("{0:n2}", Model.TotalCostBDT + (double)Model.OvalPerDayTotalSalary)</td>
                                <td class="table-body text-center @bgColor">@String.Format("{0:n2}", Model.TotalProfitBDT - (double)Model.OvalPerDayTotalSalary)</td>

                            </tr>
                            @*<tr class="table-thead">
                                <td colspan="5">Total Profit In Taka</td>
                                <td class="table-body text-center">@String.Format("{0:n2}", @Model.TotalProfitBDT) </td>
                            </tr>*@
                        </tbody>


                    </table>
                </div>
                <div class="col-md-4" style="text-align:center;">
                    <span class="col-md-12" style="text-align:center;font-weight:bold;">Robintex Group Bangladesh</span>
                    <br />
                    <span class="col-md-12" style="text-align:center;font-weight:bold;">Oval Printing Report</span>
                    <br />
                    <span class="col-md-12" style="text-align:center;font-weight:bold;">Date: @Model.ReportDateMsg</span>
                </div>
                <div class="col-md-3">
                    <table class="table table-sm table-bordered  mt-0 pt-0" style="font-weight:bold;">
                        <tr class="table-thead">
                            <td colspan="2" style="text-align:center;">Production</td>

                        </tr>
                        <tr class="table-thead">
                            <td>Chest</td>
                            <td class="table-body">@String.Format("{0:n0}", Model.TotalProductionQty) <span>Pcs</span></td>

                        </tr>

                    </table>
                </div>
            </div>



            <div class="row">
                <div class="col-md-12">
                    <div class="table-responsive-sm table-responsive-lg">
                        <table class="table table-striped table-sm mt-0 pt-0  table-bordered mdReport borderColor sticky-header">
                            <thead style="font-size:13px;vertical-align:middle">
                                <tr class="table-thead">
                                    <th style="vertical-align:middle; width:3%">SL</th>
                                    <th style="vertical-align:middle; width:5.5%">Machine</th>
                                    <th style="vertical-align:middle; width:5.5%">Buyer</th>
                                    <th style="vertical-align:middle; width:7%">Order</th>
                                    <th style="vertical-align:middle; width:8%">Style  Name</th>
                                    <th style="vertical-align:middle; width:5.5%">Color</th>
                                    <th style="vertical-align:middle; width:7%">Print  Item</th>
                                    <th style="vertical-align:middle; width:4%">Order  Qty</th>
                                    <th style="vertical-align:middle; width:6%">Production Qty</th>
                                    <th style="vertical-align:middle; width:4%">Print Prize /Dz</th>
                                    <th style="vertical-align:middle; width:3.5%">Cost /DZ</th>
                                    <th style="vertical-align:middle; width:3.5%">Profit /DZ</th>
                                    <th style="vertical-align:middle; width:5.5%">Total Price $</th>
                                    <th style="vertical-align:middle; width:5.5%">Total Cost $</th>
                                    <th style="vertical-align:middle; width:6%">Total Profit $</th>
                                    <th style="vertical-align:middle; width:7.5%">Total Price (BDT)</th>
                                    <th style="vertical-align:middle; width:7.5%">Total Cost (BDT)</th>
                                    <th style="vertical-align:middle; width:6.5%">Total Profit (BDT)</th>

                                </tr>
                            </thead>
                            <tbody class="table-body">

                                @{
                                    foreach (var aop in Model.OvalPrintingReportDetails)
                                    {
                                        sl = sl + 1;
                                        var aoptotalProfit = aop.TotalProfitBDT;
                                        bgColor = aoptotalProfit >= 0 ? "text-light bg-success" : "text-light bg-danger";

                                        <tr>
                                            <td class="text-center">@sl</td>
                                            <td class="text-center">@aop.MachineCode</td>
                                            <td class="text-center">@aop.BuyerName</td>
                                            <td class="text-center">@aop.OrderNo</td>
                                            <td class="text-center">@aop.StyleName</td>
                                            <td class="text-center">@aop.Color</td>
                                            <td>@aop.PrintItem</td>
                                            <td class="text-right">@aop.OrderQty</td>
                                            <td class="text-right">@aop.ProductionQty</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.PrintPricePerDozen)  </td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.CostPerDozen)  </td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.ProfitPerDozen)</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.TotalPrice)</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.TotalCost)</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.TotalProfit)</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.TotalPriceBDT)</td>
                                            <td class="text-right">@String.Format("{0:n2}", aop.TotalCostBDT)</td>
                                            <td class="text-right @bgColor">@String.Format("{0:n2}", aop.TotalProfitBDT)</td>
                                        </tr>

                                    }

                                }
                                <tr class="table-thead" style="font-weight:bold">
                                    <td class="text-right" colspan="8">Total</td>

                                    <td class="text-right">@String.Format("{0:n0}", Model.TotalProductionQty)</td>
                                    <td colspan="3"></td>

                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalPrice)</td>
                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalCost)</td>
                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalProfit)</td>
                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalPriceBDT)</td>
                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalCostBDT)</td>
                                    <td class="text-right">@String.Format("{0:n2}", Model.TotalProfitBDT)</td>
                                </tr>
                            </tbody>
                            <tfoot>

                            </tfoot>
                        </table>
                    </div>
                </div>


            </div>

            </div>

            @*</main>*@
        </div>
        <div class="row noprint no-print text-center">
            <div class="col-md-12">
                <input type="button" class="btn btn-danger" value="Print this page" onClick="window.print()">
            </div>
        </div>
        <script src="~/AdminLTE-3.1.0-rc/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
        @*<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>*@
        <script src="~/lib/floatThead/floatThead.js"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $(".sticky-header").floatThead({ scrollingTop: 50 });
            });
        </script>
</body>
</html>
